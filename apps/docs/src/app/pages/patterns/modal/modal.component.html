<section class="page">
  <header class="doc-card doc-card--intro">
    <p class="eyebrow">Pattern</p>
    <h2 class="docs-h1">Modal usage &amp; behavior</h2>
    <p class="overview-lead">
      A modal interrupts the primary flow to demand attention and an explicit decision.
    </p>
    <p class="overview-lead">
      It should be used with intention and moderation because it changes hierarchy, focus, and the
      perception of risk.
    </p>
    <p class="overview-lead">
      Modals also support error prevention for actions that could trigger irreversible outcomes
      without a possible rollback.
    </p>
  </header>

  <section class="section doc-card">
    <h3 class="docs-h2">When to use a modal</h3>
    <p class="docs-body">
      Use a modal when an action requires immediate attention or a focused decision.
    </p>
    <ul class="docs-list">
      <li>Confirmation of important actions.</li>
      <li>Critical information that requires immediate attention.</li>
      <li>Brief, self-contained flows.</li>
      <li>Actions that do not justify full navigation.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">When not to use a modal</h3>
    <p class="docs-body">
      Avoid modals when the content demands space, depth, or exploration.
    </p>
    <ul class="docs-list">
      <li>Long or complex forms.</li>
      <li>Content that requires exploration.</li>
      <li>Multi-step flows.</li>
      <li>Cases where a page or panel is more appropriate.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Modal types</h3>
    <p class="docs-body">Percepta supports three modal types with distinct expectations.</p>
    <div class="risk-grid">
      <div class="risk-card">
        <div class="risk-header">
          <span class="risk-badge risk-badge--low">Informational</span>
          <span class="risk-title">Low risk</span>
        </div>
        <p class="docs-body">
          Presents critical information. Expect a simple acknowledgment action.
        </p>
      </div>
      <div class="risk-card">
        <div class="risk-header">
          <span class="risk-badge risk-badge--medium">Confirmation</span>
          <span class="risk-title">Moderate risk</span>
        </div>
        <p class="docs-body">
          Confirms a decision that changes state. Expect explicit confirmation wording.
        </p>
      </div>
      <div class="risk-card">
        <div class="risk-header">
          <span class="risk-badge risk-badge--high">Destructive</span>
          <span class="risk-title">High risk</span>
        </div>
        <p class="docs-body">
          Irreversible or high-impact actions. Expect a clear cancel path and strong language.
        </p>
      </div>
    </div>
    <div class="modal-demo-row">
      <gp-button
        label="Open informational modal"
        variant="tertiary"
        (clicked)="openInfo()"
      ></gp-button>
      <gp-button
        label="Open confirmation modal"
        variant="tertiary"
        (clicked)="openConfirm()"
      ></gp-button>
      <gp-button
        label="Open destructive modal"
        variant="tertiary"
        (clicked)="openDestructive()"
      ></gp-button>
    </div>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Structure and hierarchy</h3>
    <p class="docs-body">Every modal follows the same structural contract.</p>
    <ul class="docs-list">
      <li>Header with a clear, concise title (required).</li>
      <li>Body with brief, direct content.</li>
      <li>Footer with a fixed action structure.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Actions and intent</h3>
    <p class="docs-body">
      Actions communicate intent and risk through hierarchy and tone.
    </p>
    <ul class="docs-list">
      <li>Exactly one primary action.</li>
      <li>Secondary action is optional and must be visually subordinate.</li>
      <li>Use normal or danger tone based on risk.</li>
      <li>Never include multiple primary actions.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Behavior and dismissal</h3>
    <p class="docs-body">
      Dismissal refers to closing the modal without triggering an explicit action.
      This includes pressing the ESC key or clicking on the backdrop.
    </p>
    <p class="docs-body">
      Dismissal behavior is defined by the modal type and should not be overridden
      arbitrarily by consumers. If a different dismissal behavior is required,
      a different modal type should be used.
    </p>
    <h4 class="docs-h3">Dismissal behavior by modal type</h4>
    <table class="mapping-table">
      <thead>
        <tr>
          <th scope="col">Modal type</th>
          <th scope="col">ESC key</th>
          <th scope="col">Backdrop click</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Informational</td>
          <td>Allowed</td>
          <td>Allowed</td>
        </tr>
        <tr>
          <td>Confirmation</td>
          <td>Allowed</td>
          <td>Configurable</td>
        </tr>
        <tr>
          <td>Destructive</td>
          <td>Not allowed</td>
          <td>Not allowed</td>
        </tr>
      </tbody>
    </table>
    <p class="docs-body">
      Destructive modals require an explicit user action and cannot be dismissed
      accidentally via keyboard or backdrop interaction.
    </p>
    <ul class="docs-list">
      <li>Return focus to the element that opened the modal.</li>
      <li>Block interaction with the background while open.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Accessibility considerations</h3>
    <ul class="docs-list">
      <li>Manage focus correctly inside the modal.</li>
      <li>Associate the title with the modal content.</li>
      <li>Do not rely on color alone to communicate risk.</li>
      <li>The modal must be understandable without visual context.</li>
    </ul>
  </section>

  <section class="section doc-card">
    <h3 class="docs-h2">Modal API</h3>
    <p class="docs-body">
      <strong>Selector:</strong> &lt;gp-modal&gt;&lt;/gp-modal&gt;
    </p>
    <p class="docs-body">
      <strong>Inputs (props)</strong>
    </p>
    <ul class="docs-list">
      <li><strong>open</strong>: boolean. Controls visibility; state is managed externally.</li>
      <li>
        <strong>type</strong>: 'informational' | 'confirmation' | 'destructive'. Defines intent and
        sets behavior defaults.
      </li>
      <li><strong>title</strong>: string (required). Modals cannot be title-less.</li>
      <li><strong>description</strong>: string (optional). Brief supporting text under the title.</li>
      <li><strong>primaryLabel</strong>: string (required). Primary action label.</li>
      <li><strong>secondaryLabel</strong>: string (optional). Secondary action label.</li>
      <li>
        <strong>tone</strong>: 'default' | 'danger' (optional). If omitted, derived from type.
      </li>
      <li>
        <strong>dismissible</strong>: boolean (optional). Allows ESC/backdrop close; default depends
        on type.
      </li>
      <li><strong>loading</strong>: boolean (optional). Loading state for primary action.</li>
      <li><strong>disabled</strong>: boolean (optional). Disables actions without hiding the modal.</li>
      <li><strong>width</strong>: 'sm' | 'md' | 'lg' (optional). Suggested size, not freeform.</li>
    </ul>

    <p class="docs-body">
      <strong>Slots</strong>
    </p>
    <ul class="docs-list">
      <li><strong>gpModalBody</strong> (required). Main modal content.</li>
      <li>
        <strong>gpModalFooter</strong> (optional). Custom actions for advanced cases. If omitted,
        the system renders the standard footer.
      </li>
    </ul>
    <div class="demo-box demo-box--plain">
      <pre class="code-sample">
<code>&lt;gp-modal
  [open]="isOpen"
  type="confirmation"
  title="Archive project?"
  description="You can restore it later from settings."
  primaryLabel="Archive"
  secondaryLabel="Cancel"
&gt;
  &lt;ng-template gpModalBody&gt;
    Modal content goes here.
  &lt;/ng-template&gt;
&lt;/gp-modal&gt;</code>
      </pre>
    </div>

    <p class="docs-body">
      <strong>Events (outputs)</strong>
    </p>
    <ul class="docs-list">
      <li><strong>primary</strong>: fired on primary action.</li>
      <li><strong>secondary</strong>: fired on secondary action.</li>
      <li><strong>closed</strong>: fired when the modal closes by any means.</li>
    </ul>

    <p class="docs-body">
      <strong>Behavior by type</strong>
    </p>
    <ul class="docs-list">
      <li>
        <strong>Informational</strong>: dismissible true; can have only a primary action; ESC and
        backdrop dismissal allowed.
      </li>
      <li>
        <strong>Confirmation</strong>: dismissible true; primary + secondary recommended; ESC
        allowed; backdrop configurable.
      </li>
      <li>
        <strong>Destructive</strong>: tone danger; dismissible false by default; ESC and backdrop
        dismissal disabled; requires explicit action.
      </li>
    </ul>

    <p class="docs-body">
      <strong>System rules</strong>
    </p>
    <ul class="docs-list">
      <li>Modals must have a title.</li>
      <li>Only one primary action is allowed.</li>
      <li>The footer structure is system-controlled.</li>
      <li>The modal is not a generic layout container.</li>
    </ul>

    <p class="docs-body">
      <strong>Accessibility at the API level</strong>
    </p>
    <ul class="docs-list">
      <li>The title acts as the accessible heading.</li>
      <li>Initial focus is placed predictably based on type.</li>
      <li>On close, focus returns to the element that opened the modal.</li>
      <li>The modal blocks interaction with background content.</li>
    </ul>
  </section>

  <gp-modal
    [open]="isInfoOpen"
    type="informational"
    title="Session updated"
    description="Your changes are now active."
    primaryLabel="Got it"
    (primary)="closeInfo()"
    (closed)="closeInfo()"
  >
    <ng-template gpModalBody>
      The system applied your updates successfully.
    </ng-template>
  </gp-modal>

  <gp-modal
    [open]="isConfirmOpen"
    type="confirmation"
    title="Archive project?"
    description="You can restore it later from settings."
    primaryLabel="Archive"
    secondaryLabel="Cancel"
    (primary)="closeConfirm()"
    (secondary)="closeConfirm()"
    (closed)="closeConfirm()"
  >
    <ng-template gpModalBody>
      Archiving will remove this project from active lists.
    </ng-template>
  </gp-modal>

  <gp-modal
    [open]="isDestructiveOpen"
    type="destructive"
    title="Delete record?"
    description="This action cannot be undone."
    primaryLabel="Delete"
    secondaryLabel="Cancel"
    (primary)="closeDestructive()"
    (secondary)="closeDestructive()"
    (closed)="closeDestructive()"
  >
    <ng-template gpModalBody>
      All associated data will be permanently removed.
    </ng-template>
  </gp-modal>

</section>
